import{p as ie,u as D,r as m,j as e,a as U,s as R,t as G,F as z,T as J,b as P,B as q,S as w,I as le,J as de,w as ue,A as me,x as xe,d as ge,L as he}from"./index-D7c0h0Uw.js";import{C as pe}from"./index-D8cS2rxp.js";import{u as K,C as fe,U as je}from"./transfers-stats-BLI24DF6.js";import{D as Ce,S as _e,C as Se,a as ye,E as be,M as Q,b as X,c as Y,d as Z,e as $}from"./chunk-7YYN6TNS-Cc4cFlMG.js";import{S as Me,C as Te,a as H}from"./chunk-3RSXBRAN-CVbEPzcG.js";import{H as ve}from"./chunk-7OLJDQMT-7CO27-G1.js";import{C as Ie,S as Fe,e as Ae,f as Be,g as we,N as ee,a as se,b as te,c as re,d as oe}from"./chunk-GF2QC326-BEAHCXZB.js";import{u as W}from"./index-C09T05R0.js";import{u as ne,o as ae,F as f,a as j,I as ce,b as C,c as k}from"./yup-CnYg6ZIy.js";var Le=ie({d:"M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z",displayName:"ArrowForwardIcon"});const Ee=({transfer:s})=>{const{deleteTransfer:r}=K(),{t:n}=D(),[c,o]=m.useState(!1),t=async()=>{o(!0),await r(s),o(!1)};return e.jsx(U,{onClick:t,colorScheme:"red",isLoading:c,loadingText:n("crud.buttons.deleteButtonLoadingText"),children:e.jsx(Ce,{})})},Ne=R(({setTransfer:s,onOpen:r})=>{const{transfers:n,getTransfers:c}=K(),[o,t]=m.useState(!1);return m.useEffect(()=>{(async()=>(t(!0),await c(),t(!1)))()},[]),o?e.jsx(G,{}):e.jsx(z,{direction:"column",gap:4,children:e.jsx(_e,{columns:{base:1,sm:2,lg:3,xl:4},spacing:"20px",children:n.map(i=>e.jsx(He,{transfer:i,onOpen:r,setTransfer:s},i.id))})})}),He=({setTransfer:s,transfer:r,onOpen:n})=>{const c=()=>{s(r),n()};return e.jsx(Me,{initialScale:.9,in:!0,children:e.jsxs(Te,{borderColor:"red",children:[e.jsx(Se,{children:e.jsx(ve,{size:"sm",as:z,gap:2,align:"center",justifyContent:"space-between",children:e.jsx(J,{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",children:r.title})})}),e.jsx(Ie,{py:0,children:e.jsxs(Fe,{children:[e.jsxs(Ae,{display:"flex",gap:2,alignItems:"center",children:[r.account_from.title,e.jsx(Le,{}),r.account_to.title]}),e.jsxs(Be,{children:[r.amount," ",r.account_from.currency.code]}),e.jsx(we,{children:r.created_at})]})}),e.jsxs(ye,{gap:5,children:[e.jsx(U,{onClick:c,children:e.jsx(be,{})}),e.jsx(Ee,{transfer:r})]})]})})},ke=R(({isOpen:s,onClose:r})=>{var N,M,T,v,I,F,A,B;const{accounts:n,getAccounts:c}=W(),{t:o}=D(),{colorMode:t}=P(),[i,_]=m.useState(null),[S,h]=m.useState(null),{register:p,handleSubmit:y,reset:O,formState:{errors:l,isValid:d}}=ne({resolver:ae(le)});m.useEffect(()=>{(async()=>await c())()},[]),m.useEffect(()=>{L(1),E(1)},[n]);const L=a=>{const x=n.find(b=>b.id===a);x&&_(x.currency)},E=a=>{const x=n.find(b=>b.id===a);x&&h(x.currency)};return e.jsxs(Q,{isOpen:s,onClose:r,isCentered:!0,size:"sm",children:[e.jsx(X,{}),e.jsxs(Y,{maxW:{base:"calc(100% - 32px)",sm:400},children:[e.jsx(Z,{pt:5,px:5,pb:0,children:o("pages.transfers.createModal.form.title")}),e.jsx($,{top:5,right:5}),e.jsx(z,{direction:"column",gap:4,children:e.jsx(q,{rounded:"lg",bg:t==="light"?"gray.50":"gray.700",boxShadow:"lg",p:5,children:e.jsxs(w,{spacing:4,children:[e.jsxs(f,{isInvalid:!!((N=l.title)!=null&&N.message),children:[e.jsxs(j,{children:[o("pages.transfers.createModal.form.fields.title"),":"]}),e.jsx(ce,{...p("title"),type:"text",focusBorderColor:t==="light"?"green.500":"green.200",placeholder:o("pages.transfers.createModal.form.placeholders.title")}),l.title&&e.jsx(C,{children:(M=l.title)==null?void 0:M.message})]}),e.jsxs(f,{isInvalid:!!((T=l.amount)!=null&&T.message),children:[e.jsxs(j,{children:[o("pages.transfers.createModal.form.fields.amount"),":"]}),e.jsxs(ee,{defaultValue:1e3,precision:2,min:0,max:1e9,step:10,focusBorderColor:t==="light"?"green.500":"green.200",children:[e.jsx(se,{...p("amount")}),e.jsxs(te,{children:[e.jsx(re,{}),e.jsx(oe,{})]})]}),l.amount&&e.jsx(C,{children:(v=l.amount)==null?void 0:v.message})]}),e.jsxs(f,{isInvalid:!!((I=l.account_from_id)!=null&&I.message),children:[e.jsxs(j,{children:[o("pages.transfers.createModal.form.fields.account_from"),":"]}),e.jsx(H,{...p("account_from_id"),focusBorderColor:t==="light"?"green.500":"green.200",onChange:a=>L(Number(a.target.value)),children:n.map(({id:a,title:x})=>e.jsx("option",{value:a,children:x},a))}),i&&e.jsxs(k,{children:[o("pages.transfers.createModal.form.accountFromCurrency")," - ",i.title," (",i.code,")"]}),l.account_from_id&&e.jsx(C,{children:(F=l.account_from_id)==null?void 0:F.message})]}),e.jsxs(f,{isInvalid:!!((A=l.account_to_id)!=null&&A.message),children:[e.jsxs(j,{children:[o("pages.transfers.createModal.form.fields.account_to"),":"]}),e.jsx(H,{...p("account_to_id"),focusBorderColor:t==="light"?"green.500":"green.200",onChange:a=>E(Number(a.target.value)),children:n.map(({id:a,title:x})=>e.jsx("option",{value:a,children:x},a))}),S&&e.jsxs(k,{children:[o("pages.transfers.createModal.form.accountToCurrency")," - ",S.title," (",S.code,")"]}),l.account_to_id&&e.jsx(C,{children:(B=l.account_to_id)==null?void 0:B.message})]}),e.jsx(w,{spacing:10,pt:2,children:e.jsx(fe,{reset:O,isValid:d,handleSubmit:y,onSubmit:r})})]})})})]})]})}),De=R(({transfer:s,isOpen:r,onClose:n})=>{var M,T,v,I,F,A,B,a,x,b;const{accounts:c,getAccounts:o}=W(),{t}=D(),{colorMode:i}=P(),[_,S]=m.useState((M=s==null?void 0:s.account_from)==null?void 0:M.currency),[h,p]=m.useState((T=s==null?void 0:s.account_to)==null?void 0:T.currency),{register:y,handleSubmit:O,reset:l,formState:{errors:d,isValid:L}}=ne({resolver:ae(de),defaultValues:{title:s.title,amount:String(s.amount),account_from_id:s.account_from.id,account_to_id:s.account_to.id}});m.useEffect(()=>{(async()=>await o())()},[]);const E=u=>{const g=c.find(V=>V.id===u);g&&S(g.currency)},N=u=>{const g=c.find(V=>V.id===u);g&&p(g.currency)};return e.jsxs(Q,{isOpen:r,onClose:n,isCentered:!0,size:"sm",children:[e.jsx(X,{}),e.jsxs(Y,{maxW:{base:"calc(100% - 32px)",sm:400},children:[e.jsx(Z,{pt:5,px:5,pb:0,children:t("pages.transfers.editModal.form.title")}),e.jsx($,{top:5,right:5}),e.jsx(z,{direction:"column",gap:4,children:e.jsx(q,{rounded:"lg",bg:i==="light"?"gray.50":"gray.700",boxShadow:"lg",p:5,children:e.jsxs(w,{spacing:4,children:[e.jsxs(f,{isInvalid:!!((v=d.title)!=null&&v.message),children:[e.jsxs(j,{children:[t("pages.transfers.editModal.form.fields.title"),":"]}),e.jsx(ce,{...y("title"),type:"text",focusBorderColor:i==="light"?"green.500":"green.200",placeholder:t("pages.transfers.editModal.form.placeholders.title")}),d.title&&e.jsx(C,{children:(I=d.title)==null?void 0:I.message})]}),e.jsxs(f,{isInvalid:!!((F=d.amount)!=null&&F.message),children:[e.jsxs(j,{children:[t("pages.expenses.editModal.form.fields.amount"),":"]}),e.jsxs(ee,{precision:2,min:0,max:1e9,step:10,focusBorderColor:i==="light"?"green.500":"green.200",children:[e.jsx(se,{...y("amount")}),e.jsxs(te,{children:[e.jsx(re,{}),e.jsx(oe,{})]})]}),d.amount&&e.jsx(C,{children:(A=d.amount)==null?void 0:A.message})]}),e.jsxs(f,{isInvalid:!!((B=d.account_from_id)!=null&&B.message),children:[e.jsxs(j,{children:[t("pages.transfers.editModal.form.fields.account_from"),":"]}),e.jsx(H,{...y("account_from_id"),focusBorderColor:i==="light"?"green.500":"green.200",onChange:u=>E(Number(u.target.value)),children:c.map(({id:u,title:g})=>e.jsx("option",{value:u,children:g},u))}),_&&e.jsxs(k,{children:[t("pages.transfers.editModal.form.accountFromCurrency")," - ",_.title," (",_.code,")"]}),d.account_from_id&&e.jsx(C,{children:(a=d.account_from_id)==null?void 0:a.message})]}),e.jsxs(f,{isInvalid:!!((x=d.account_to_id)!=null&&x.message),children:[e.jsxs(j,{children:[t("pages.transfers.editModal.form.fields.account_to"),":"]}),e.jsx(H,{...y("account_to_id"),focusBorderColor:i==="light"?"green.500":"green.200",onChange:u=>N(Number(u.target.value)),children:c.map(({id:u,title:g})=>e.jsx("option",{value:u,children:g},u))}),h&&e.jsxs(k,{children:[t("pages.transfers.editModal.form.accountToCurrency")," - ",h.title," (",h.code,")"]}),d.account_to_id&&e.jsx(C,{children:(b=d.account_to_id)==null?void 0:b.message})]}),e.jsx(w,{spacing:10,pt:2,children:e.jsx(je,{id:s.id,reset:l,isValid:L,handleSubmit:O,onSubmit:n})})]})})})]})]})});function qe(){const{t:s}=D(),[r,n]=m.useState(null),{isOpen:c,onOpen:o,onClose:t}=ue(),{accounts:i,getAccounts:_}=W(),[S,h]=m.useState(!1),p=()=>{t(),n(null)};return m.useEffect(()=>{(async()=>(h(!0),await _(),h(!1)))()},[]),S?e.jsx(G,{}):e.jsx(pe,{children:e.jsxs(w,{pt:2,gap:6,children:[i.length<2&&e.jsxs(me,{borderRadius:"md",status:"info",children:[e.jsx(xe,{}),e.jsxs(J,{children:[s("advices.createTwoAccountsAdvice")," ",e.jsx("br",{}),e.jsx(ge,{as:he,fontSize:"md",to:"/accounts",children:s("header.navigation.accounts")})]})]}),e.jsx(U,{onClick:o,children:s("crud.buttons.createButton")}),e.jsx(ke,{isOpen:c&&!r,onClose:t}),r&&e.jsx(De,{transfer:r,isOpen:c,onClose:p}),e.jsx(Ne,{onOpen:o,setTransfer:n})]})})}export{qe as default};
