import{u as D,r as g,j as e,a as z,s as H,b as q,F as O,B as J,S as L,C as xe,t as K,T as k,D as ge,w as me,A as P,x as W,d as G,L as X}from"./index-MUysnvcQ.js";import{C as pe}from"./index-BRO95Hzj.js";import{u as V}from"./index-BvdUDHzz.js";import{C as R}from"./models-CjZ-GPCS.js";import{u as U}from"./hooks-DW70Zt03.js";import{u as Q,C as he,U as je}from"./expenses-stats-BRL4LJ6v.js";import{u as Y,o as Z,F as f,a as C,I as $,b as S,c as ee}from"./yup-DtsONAk4.js";import{D as fe,M as se,b as te,c as re,d as ae,e as ne,S as Ce,C as Se,a as ye,E as be}from"./chunk-7YYN6TNS-DG8wj-tU.js";import{N as oe,a as ce,b as ie,c as le,d as de,C as Ee,S as Me,e as ve,f as Be,g as Ie}from"./chunk-GF2QC326-txoMu6CN.js";import{a as T,S as _e,C as we}from"./chunk-3RSXBRAN-DXCZU21v.js";import{H as Ae}from"./chunk-7OLJDQMT-DxeF1vhE.js";import{B as Fe}from"./chunk-Z6RXEUPO-D71hXSAC.js";const Le=({expense:s})=>{const{deleteExpense:t}=Q(),{t:i}=D(),[l,d]=g.useState(!1),p=async()=>{d(!0),await t(s),d(!1)};return e.jsx(z,{onClick:p,colorScheme:"red",isLoading:l,loadingText:i("crud.buttons.deleteButtonLoadingText"),children:e.jsx(fe,{})})},Ne=H(({isOpen:s,onClose:t})=>{var N,v,B,I,_,w,A,F;const{categories:i,getCategories:l}=U(),{accounts:d,getAccounts:p}=V(),{t:n}=D(),{colorMode:o}=q(),[m,y]=g.useState(null),{register:u,handleSubmit:j,reset:M,formState:{errors:r,isValid:a}}=Y({resolver:Z(xe)});g.useEffect(()=>{(async()=>(await l(),await p()))()},[]),g.useEffect(()=>{b(1)},[d]);const b=c=>{const h=d.find(x=>x.id===c);h&&y(h.currency)};return e.jsxs(se,{isOpen:s,onClose:t,isCentered:!0,size:"sm",children:[e.jsx(te,{}),e.jsxs(re,{maxW:{base:"calc(100% - 32px)",sm:400},children:[e.jsx(ae,{pt:5,px:5,pb:0,children:n("pages.expenses.createModal.form.title")}),e.jsx(ne,{top:5,right:5}),e.jsx(O,{direction:"column",gap:4,children:e.jsx(J,{rounded:"lg",bg:o==="light"?"gray.50":"gray.700",boxShadow:"lg",p:5,children:e.jsxs(L,{spacing:4,children:[e.jsxs(f,{isInvalid:!!((N=r.title)!=null&&N.message),children:[e.jsxs(C,{children:[n("pages.expenses.createModal.form.fields.title"),":"]}),e.jsx($,{...u("title"),type:"text",focusBorderColor:o==="light"?"green.500":"green.200",placeholder:n("pages.expenses.createModal.form.placeholders.title")}),r.title&&e.jsx(S,{children:(v=r.title)==null?void 0:v.message})]}),e.jsxs(f,{isInvalid:!!((B=r.amount)!=null&&B.message),children:[e.jsxs(C,{children:[n("pages.expenses.createModal.form.fields.amount"),":"]}),e.jsxs(oe,{defaultValue:1e3,precision:2,min:0,max:1e9,step:10,focusBorderColor:o==="light"?"green.500":"green.200",children:[e.jsx(ce,{...u("amount")}),e.jsxs(ie,{children:[e.jsx(le,{}),e.jsx(de,{})]})]}),r.amount&&e.jsx(S,{children:(I=r.amount)==null?void 0:I.message})]}),e.jsxs(f,{isInvalid:!!((_=r.category_id)!=null&&_.message),children:[e.jsxs(C,{children:[n("pages.expenses.createModal.form.fields.category"),":"]}),e.jsx(T,{...u("category_id"),focusBorderColor:o==="light"?"green.500":"green.200",children:i.filter(c=>c.type!==R.INCOMES).map(({id:c,title:h})=>e.jsx("option",{value:c,children:h},c))}),r.category_id&&e.jsx(S,{children:(w=r.category_id)==null?void 0:w.message})]}),e.jsxs(f,{isInvalid:!!((A=r.account_id)!=null&&A.message),children:[e.jsxs(C,{children:[n("pages.expenses.createModal.form.fields.account"),":"]}),e.jsx(T,{...u("account_id"),focusBorderColor:o==="light"?"green.500":"green.200",onChange:c=>b(Number(c.target.value)),children:d.map(({id:c,title:h})=>e.jsx("option",{value:c,children:h},c))}),m&&e.jsxs(ee,{children:[n("pages.expenses.createModal.form.accountCurrency")," - ",m.title," (",m.code,")"]}),r.account_id&&e.jsx(S,{children:(F=r.account_id)==null?void 0:F.message})]}),e.jsx(L,{spacing:10,pt:2,children:e.jsx(he,{reset:M,isValid:a,handleSubmit:j,onSubmit:t})})]})})})]})]})}),Te=H(({setExpense:s,onOpen:t})=>{const{expenses:i,getExpenses:l}=Q(),[d,p]=g.useState(!1);return g.useEffect(()=>{(async()=>(p(!0),await l(),p(!1)))()},[]),d?e.jsx(K,{}):e.jsx(O,{direction:"column",gap:4,children:e.jsx(Ce,{columns:{base:1,sm:2,lg:3,xl:4},spacing:"20px",children:i.map(n=>e.jsx(De,{expense:n,onOpen:t,setExpense:s},n.id))})})}),De=({setExpense:s,expense:t,onOpen:i})=>{const l=()=>{s(t),i()};return e.jsx(_e,{initialScale:.9,in:!0,children:e.jsxs(we,{borderColor:"red",children:[e.jsx(Se,{children:e.jsxs(Ae,{size:"sm",as:O,gap:2,align:"center",justifyContent:"space-between",children:[e.jsx(k,{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",children:t.title}),e.jsx(Fe,{fontSize:"0.7em",colorScheme:"red",px:2,py:1,children:t.category.title})]})}),e.jsx(Ee,{py:0,children:e.jsxs(Me,{children:[e.jsx(ve,{children:t.account.title}),e.jsxs(Be,{children:["- ",t.amount," ",t.account.currency.code]}),e.jsx(Ie,{children:t.created_at})]})}),e.jsxs(ye,{gap:5,children:[e.jsx(z,{onClick:l,children:e.jsx(be,{})}),e.jsx(Le,{expense:t})]})]})})},Oe=H(({expense:s,isOpen:t,onClose:i})=>{var v,B,I,_,w,A,F,c,h;const{accounts:l,getAccounts:d}=V(),{categories:p,getCategories:n}=U(),{t:o}=D(),{colorMode:m}=q(),[y,u]=g.useState((v=s==null?void 0:s.account)==null?void 0:v.currency),{register:j,handleSubmit:M,reset:r,formState:{errors:a,isValid:b}}=Y({resolver:Z(ge),defaultValues:{title:s.title,amount:String(s.amount),category_id:s.category.id,account_id:s.account.id}});g.useEffect(()=>{(async()=>(await d(),await n()))()},[]);const N=x=>{const E=l.find(ue=>ue.id===x);E&&u(E.currency)};return e.jsxs(se,{isOpen:t,onClose:i,isCentered:!0,size:"sm",children:[e.jsx(te,{}),e.jsxs(re,{maxW:{base:"calc(100% - 32px)",sm:400},children:[e.jsx(ae,{pt:5,px:5,pb:0,children:o("pages.expenses.editModal.form.title")}),e.jsx(ne,{top:5,right:5}),e.jsx(O,{direction:"column",gap:4,children:e.jsx(J,{rounded:"lg",bg:m==="light"?"gray.50":"gray.700",boxShadow:"lg",p:5,children:e.jsxs(L,{spacing:4,children:[e.jsxs(f,{isInvalid:!!((B=a.title)!=null&&B.message),children:[e.jsxs(C,{children:[o("pages.expenses.editModal.form.fields.title"),":"]}),e.jsx($,{...j("title"),type:"text",focusBorderColor:m==="light"?"green.500":"green.200",placeholder:o("pages.expenses.editModal.form.placeholders.title")}),a.title&&e.jsx(S,{children:(I=a.title)==null?void 0:I.message})]}),e.jsxs(f,{isInvalid:!!((_=a.amount)!=null&&_.message),children:[e.jsxs(C,{children:[o("pages.expenses.editModal.form.fields.amount"),":"]}),e.jsxs(oe,{precision:2,min:0,max:1e9,step:10,focusBorderColor:m==="light"?"green.500":"green.200",children:[e.jsx(ce,{...j("amount")}),e.jsxs(ie,{children:[e.jsx(le,{}),e.jsx(de,{})]})]}),a.amount&&e.jsx(S,{children:(w=a.amount)==null?void 0:w.message})]}),e.jsxs(f,{isInvalid:!!((A=a.category_id)!=null&&A.message),children:[e.jsxs(C,{children:[o("pages.expenses.editModal.form.fields.category"),":"]}),e.jsx(T,{...j("category_id"),focusBorderColor:m==="light"?"green.500":"green.200",children:p.filter(x=>x.type!==R.INCOMES).map(({id:x,title:E})=>e.jsx("option",{value:x,children:E},x))}),a.category_id&&e.jsx(S,{children:(F=a.category_id)==null?void 0:F.message})]}),e.jsxs(f,{isInvalid:!!((c=a.account_id)!=null&&c.message),children:[e.jsxs(C,{children:[o("pages.expenses.editModal.form.fields.account"),":"]}),e.jsx(T,{...j("account_id"),focusBorderColor:m==="light"?"green.500":"green.200",onChange:x=>N(Number(x.target.value)),children:l.map(({id:x,title:E})=>e.jsx("option",{value:x,children:E},x))}),y&&e.jsxs(ee,{children:[o("pages.expenses.editModal.form.accountCurrency")," - ",y.title," (",y.code,")"]}),a.account_id&&e.jsx(S,{children:(h=a.account_id)==null?void 0:h.message})]}),e.jsx(L,{spacing:10,pt:2,children:e.jsx(je,{id:s.id,reset:r,isValid:b,handleSubmit:M,onSubmit:i})})]})})})]})]})});function Ke(){const{t:s}=D(),[t,i]=g.useState(null),{isOpen:l,onOpen:d,onClose:p}=me(),{categories:n,getCategories:o}=U(),{accounts:m,getAccounts:y}=V(),[u,j]=g.useState(),[M,r]=g.useState(!1),a=()=>{p(),i(null)};return g.useEffect(()=>{r(!0),j(n.filter(b=>b.type===R.EXPENSES)),r(!1)},[n]),g.useEffect(()=>{(async()=>(r(!0),await o(),await y(),r(!1)))()},[]),M?e.jsx(K,{}):e.jsx(pe,{children:e.jsxs(L,{pt:2,gap:6,children:[!(u!=null&&u.length)&&e.jsxs(P,{borderRadius:"md",status:"info",children:[e.jsx(W,{}),e.jsxs(k,{children:[s("advices.createExpenseCategoryFirstAdvice")," ",e.jsx("br",{}),e.jsx(G,{as:X,fontSize:"md",to:"/categories",children:s("header.navigation.categories")})]})]}),!m.length&&e.jsxs(P,{borderRadius:"md",status:"info",children:[e.jsx(W,{}),e.jsxs(k,{children:[s("advices.createAccountFirstAdvice")," ",e.jsx("br",{}),e.jsx(G,{as:X,fontSize:"md",to:"/accounts",children:s("header.navigation.accounts")})]})]}),(u==null?void 0:u.length)&&m.length&&e.jsx(z,{onClick:d,children:s("crud.buttons.createButton")}),e.jsx(Ne,{isOpen:l&&!t,onClose:p}),t&&e.jsx(Oe,{expense:t,isOpen:l,onClose:a}),e.jsx(Te,{onOpen:d,setExpense:i})]})})}export{Ke as default};
